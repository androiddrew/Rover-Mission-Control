(this["webpackJsonpRover-MCT"]=this["webpackJsonpRover-MCT"]||[]).push([[0],{193:function(e,t){e.exports={defaultRoverIp:"192.168.4.1:80/ws"}},232:function(e,t,a){e.exports=a(469)},241:function(e,t,a){},242:function(e,t,a){},469:function(e,t,a){"use strict";a.r(t);a(233),a(234),a(235),a(236);var n=a(0),r=a.n(n),s=a(28),o=a.n(s),i=(a(241),a(19)),c=a(20),l=a(23),d=a(21),m=a(22),u=(a(242),a(200)),h=a(15),p=a(470),g=a(471),y=a(106),b=a.n(y),f=a(30),C=a(193),w=a.n(C),E=a(202),v=a(201),S=a(474),O=a(57),k=a(58),j={container:{position:"fixed",bottom:0,left:0,width:"100%",padding:"5px 0",background:"#424242",color:"#777E87",boxShadow:"0px 0px 5px 0px rgba(25, 25, 25, 0.75)",textAlign:"left",margin:0},toolbarColumn:{borderColor:"yellow",borderWidth:5,borderRadius:2},toolbarRow:{paddingTop:3},toolbarIcon:{color:"white",fontSize:"1em"}},A=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={ipAddress:a.props.defaultIpAddress},a.handleChange=a.handleChange.bind(Object(h.a)(a)),a.handleUrlChange=a.handleUrlChange.bind(Object(h.a)(a)),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"handleChange",value:function(e){this.setState({ipAddress:e.target.value})}},{key:"handleUrlChange",value:function(e){this.setState({imageUrl:e.target.value})}},{key:"renderConnectButton",value:function(){var e=this,t=null,a=this.props.isConnected?"danger":"success";return t=this.props.isConnecting?r.a.createElement(O.a,{icon:k.c,spin:!0,style:j.toolbarIcon}):this.props.isConnected?r.a.createElement(O.a,{icon:k.d,style:j.toolbarIcon}):r.a.createElement(O.a,{icon:k.b,style:j.toolbarIcon}),r.a.createElement(v.a,{bsStyle:a,onClick:function(){return e.props.onConnectDisconnect(e.state.ipAddress)}},t)}},{key:"render",value:function(){return r.a.createElement("div",{style:Object(E.a)({},j.container)},r.a.createElement(p.a,{mdHidden:!0,styles:j.toolbarColumn,md:12},r.a.createElement(g.a,{xs:12},r.a.createElement(p.a,{xs:2},this.renderConnectButton()),r.a.createElement(p.a,{xs:3},r.a.createElement(S.a,{type:"text",value:this.state.ipAddress,placeholder:"Enter IP Address",onChange:this.handleChange,disabled:this.props.isConnected})),r.a.createElement(p.a,{xs:3},r.a.createElement(v.a,{bsStyle:"primary",onClick:this.props.onModeSwitch},r.a.createElement(O.a,{icon:k.a,style:j.toolbarIcon}))))))}}]),t}(r.a.Component);A.defaultProps={defaultIpAddress:""};var x=a(472),D=a(473),T={container:{textAlign:"center",width:"100%",height:"100%"},image:{maxWidth:"100%",height:"85%"},button:{padding:4}},Y=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(d.a)(t).call(this,e))).startStream=a.startStream.bind(Object(h.a)(a)),a.stopStream=a.stopStream.bind(Object(h.a)(a)),a.captureStill=a.captureStill.bind(Object(h.a)(a)),a.state={imgSrc:""},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e,t){this.props.isConnected&&!e.isConnected&&this.props.setQualityAddress&&fetch(this.props.setQualityAddress).catch((function(e){return console.log("Failed setting quality")}))}},{key:"startStream",value:function(){this.setState({imgSrc:this.props.streamAddress})}},{key:"stopStream",value:function(){this.setState({imgSrc:""})}},{key:"captureStill",value:function(){this.setState({imgSrc:this.props.captureAddress+"?"+(new Date).getTime()})}},{key:"render",value:function(){return r.a.createElement(x.a,{style:T.container},r.a.createElement(D.a,null,r.a.createElement(v.a,{style:T.button,bsSize:"small",bsStyle:"success",onClick:this.startStream},"Start stream"),r.a.createElement(v.a,{style:T.button,bsSize:"small",bsStyle:"danger",onClick:this.stopStream},"Stop stream"),r.a.createElement(v.a,{style:T.button,bsSize:"small",bsStyle:"primary",onClick:this.captureStill},"Screenshot")),r.a.createElement("img",{style:T.image,src:this.state.imgSrc,alt:""}))}}]),t}(r.a.Component);Y.defaultProps={streamAddress:"http://192.168.4.10:81/stream",captureAddress:"http://192.168.4.10/capture",setQualityAddress:"http://192.168.4.10/control?var=quality&val=30"};var I=a(24),M=a.n(I),G={container:{textAlign:"left",maxWidth:"100%",maxHeight:"100%",overflow:"hidden"},header:{color:"white",fontSize:"0.9em",fontWeight:"bold"},dateTime:{color:"white"}},L=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={startDateTime:M()(),currentTime:new Date},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;setInterval((function(){return e.setState({currentDate:new Date})}),1e3)}},{key:"renderComms",value:function(e){return e.slice(Math.max(e.length-4,1)).map((function(e,t){return r.a.createElement(g.a,{key:e.dateTime+t,style:G.dateTime},r.a.createElement(p.a,{md:12},"".concat(M()(e.dateTime).format("YYYY-MM-DD HH:mm:ss.SSS")," ").concat(e.size," bytes")))}))}},{key:"render",value:function(){var e=this.props.latestData,t=M()(),a=t.format("ll LTS"),n=M()(t,"DD/MM/YYYY HH:mm:ss").diff(M()(this.state.startDateTime,"DD/MM/YYYY HH:mm:ss")),s=M.a.duration(n),o=Math.floor(s.asHours())+M.a.utc(n).format(":mm:ss"),i=0;return e.length>0&&(i=M()(e[e.length-1].dateTime).diff(M()(e[0].dateTime))/e.length),r.a.createElement(x.a,{style:G.container},r.a.createElement(g.a,{style:G.header},r.a.createElement(p.a,{md:6},"Current time"),r.a.createElement(p.a,{md:6},"Elapsed Time")),r.a.createElement(g.a,{style:G.dateTime},r.a.createElement(p.a,{md:6},a),r.a.createElement(p.a,{md:6},o)),r.a.createElement(g.a,null,r.a.createElement(p.a,{md:6,style:G.header},this.props.latestData.length>0?"Comms":""),r.a.createElement(p.a,{hidden:0===i,md:6,style:G.dateTime},"Avg. interval ".concat(parseInt(i)))),r.a.createElement(g.a,null,r.a.createElement(p.a,{md:6},this.renderComms(this.props.latestData)),r.a.createElement(p.a,{md:6},"N/A")))}}]),t}(r.a.Component);L.defaultProps={};var H=["#8884d8","#82ca9d","#CCCC00"],z=Object(y.WidthProvider)(b.a),W={gridCard:{backgroundColor:"#292929",borderRadius:10}},X=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(l.a)(this,Object(d.a)(t).call(this))).state={wsOpen:!1,wsClosing:!1,wsConnecting:!1,data:[]},e.ip=w.a.defaultRoverIp,e.connect=e.connect.bind(Object(h.a)(e)),e.connectDisconnectClicked=e.connectDisconnectClicked.bind(Object(h.a)(e)),e.renderGraph=e.renderGraph.bind(Object(h.a)(e)),e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"connect",value:function(e){var t=this;this.ws=new WebSocket("ws://".concat(e)),this.ws.binaryType="arraybuffer",this.state.wsClosing||this.state.wsOpen?console.error("ws is in closing or closed state"):(this.setState({wsConnecting:!0,wsClosing:!1}),this.ws.onopen=function(){console.log("WebSocket open"),t.setState({wsOpen:!0,wsConnecting:!1,wsClosing:!1}),t.ws.send("CONNECT")},this.ws.onclose=function(){console.log("WebSocket close"),t.setState({wsOpen:!1,wsConnecting:!1,wsClosing:!1})},this.ws.onerror=function(e){console.log(e),t.setState({wsOpen:!1,wsConnecting:!1,wsClosing:!1})},this.ws.onmessage=function(e){if(52===e.data.byteLength){var a=new Float32Array(e.data),n={temp:a[0],accX:a[1],accY:a[2],accZ:a[3],gyroX:a[4],gyroY:a[5],gyroZ:a[6],gyroAngleX:a[7],gyroAngleY:a[8],gyroAngleZ:a[9],angleX:a[10],angleY:a[11],angleZ:a[12],dateTime:new Date,size:e.data.byteLength};console.log(n),t.setState({data:[].concat(Object(u.a)(t.state.data),[n]).filter(t.removeOldData)})}else console.log(e)})}},{key:"removeOldData",value:function(e){var t=new Date;return e.dateTime>new Date(t.getTime()-1e4)}},{key:"connectDisconnectClicked",value:function(e){this.state.wsOpen?(this.setState({wsClosing:!0}),this.ws.close()):this.connect(e)}},{key:"renderGraph",value:function(e,t,a){return r.a.createElement("div",{key:e,style:W.gridCard},r.a.createElement(f.e,null,r.a.createElement(f.d,{data:this.state.data},r.a.createElement(f.a,{strokeDasharray:"3 3"}),r.a.createElement(f.g,{tick:!1},r.a.createElement(f.b,{value:t,offset:0,style:{fill:"green",fontSize:"1.4em"},position:"insideLeft"})),r.a.createElement(f.h,{axisLine:!1,tickLine:!1}),r.a.createElement(f.f,null),a.map((function(e,t){return r.a.createElement(f.c,{key:e,type:"monotone",dataKey:e,stroke:H[t%H.length],fill:H[t%H.length]})})))))}},{key:"generateLayout",value:function(){return[{i:"status",x:0,y:0,w:4,h:1},{i:"g0",x:4,y:0,w:4,h:1},{i:"g1",x:8,y:0,w:4,h:1},{i:"g2",x:0,y:4,w:4,h:1},{i:"g3",x:4,y:8,w:4,h:1},{i:"g4",x:8,y:8,w:2,h:1},{i:"g5",x:10,y:8,w:2,h:1}]}},{key:"render",value:function(){return r.a.createElement("div",{className:"drawArea",ref:"drawArea"},r.a.createElement(p.a,{className:"Container"},r.a.createElement(z,Object.assign({layout:this.generateLayout(),onLayoutChange:this.onLayoutChange},this.props),r.a.createElement("div",{key:"status",style:W.gridCard},r.a.createElement(L,{latestData:this.state.data})),this.renderGraph("g0","Gyro",["gyroX","gyroY","gyroZ"]),r.a.createElement("div",{key:"g1",style:W.gridCard},r.a.createElement(Y,{isConnected:this.state.wsOpen})),this.renderGraph("g2","Acc",["accX","accY","accZ"]),this.renderGraph("g3","Angle",["angleX","angleY","angleZ"]),this.renderGraph("g4","GyroAngle",["gyroAngleX","gyroAngleY","gyroAngleZ"]),this.renderGraph("g5","Temperature",["temp"])),r.a.createElement(g.a,{xs:2},r.a.createElement(A,{defaultIpAddress:this.ip,isConnected:this.state.wsOpen,isConnecting:this.state.wsConnecting,onConnectDisconnect:this.connectDisconnectClicked}))))}}]),t}(n.Component),Z=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(X,null))}}]),t}(n.Component);o.a.render(r.a.createElement(Z,null),document.getElementById("root"))}},[[232,1,2]]]);
//# sourceMappingURL=main.ac38a4fe.chunk.js.map